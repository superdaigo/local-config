#+TITLE: Tmux configuration

* Requirement
- Tmux
- Emacs (to generate the configuration file)
- reattach-to-user-namespace (for Mac)

* Generate config file

Execute the following elisp babel code to create and replace ~.tmux.conf~ file.

#+begin_src elisp
  ;; Generate configuration file
  (org-babel-tangle-file "tmux.org")
  (setq-local dest-file (expand-file-name "~/.tmux.conf"))
  (setq-local backup-prefix (concat "tmux/" (format-time-string "%Y-%m-%d_%H%M%S_")))
  ;; Take backup
  (if (file-exists-p dest-file)
      (copy-file dest-file (concat backup-prefix ".tmux.conf"))
    nil)
  ;; Save new file
  (copy-file "tmux/.tmux.conf" dest-file t)
#+end_src

#+RESULTS:

Press ~C-z :~ and execute ~source-file ~/.tmux.conf~

* Tmux configuration

Tested on tmux 3.4

** Head of ~.tmux.conf~ file

#+begin_src conf :tangle tmux/.tmux.conf :mkdirp t
  # -*- coding: utf-8 -*-
  # Generated by tmux.org file
  # ~/.tmux.conf
#+end_src

** Change default key

#+begin_src conf :tangle tmux/.tmux.conf
  # Change default prefix C-b -> C-z
  set -g prefix "C-z"
#+end_src

** Split panes

#+begin_src conf :tangle tmux/.tmux.conf
  # splitting panes with | and -
  bind | split-window -h
  bind - split-window -v
#+end_src

** Copy to clipboard - Linux

This requires ~xsel~ command.

#+begin_src conf :tangle (if (eq system-type 'gnu/linux) "tmux/.tmux.conf" "")
  # Copy to clipboard usin xsel
  set -s copy-command 'xsel --clipboard -i'
#+end_src

** Copy to clipboard - macOS

This requires ~reattach-to-user-namespace~ command.

#+begin_src conf :tangle (if (eq system-type 'darwin) "tmux/.tmux.conf" "")
  # brew install reattach-to-user-namespace
  set-option -g default-command "reattach-to-user-namespace -l $SHELL"
  # Sync clipboard when copy-mode C-w
  bind-key -T copy-mode M-w send-keys -X copy-pipe-and-cancel "reattach-to-user-namespace pbcopy"\; display-message "copied to system clipboard"
#+end_src


** True Color

Chante ot true color

#+begin_src conf :tangle tmux/.tmux.conf
  # See https://github.com/tmux/tmux/wiki/FAQ#how-do-i-use-rgb-colour.
  set -as terminal-overrides ",xterm-256color:RGB"
#+end_src

** Mouse mode

Enables simple mouse operations.
- Select buffer/window using mouse click
- Scroll tmux buffer using mouse wheel
- Right click to show tmux menu

#+begin_src conf :tangle tmux/.tmux.conf
  # Turn on simple mouse operation
  set -g mouse on
#+end_src


